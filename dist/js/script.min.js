const LOCAL_STORAGE_PREFIX="COSTS_v2_LOCAL",THEME_STORAGE_KEY=`${"COSTS_v2_LOCAL"}-switcher`,CURRENCY_STORAGE_KEY=`${"COSTS_v2_LOCAL"}-currency`,COSTS_STORAGE_KEY=`${"COSTS_v2_LOCAL"}-entries`,SORT_DATE_BUTTONS_STORAGE_KEY=`${"COSTS_v2_LOCAL"}-sort-buttons-enabled`;themeSwitcher();function themeSwitcher(){function a(){f.classList.add("hide"),d.classList.remove("hide"),h.textContent="off"}function b(){d.classList.add("hide"),f.classList.remove("hide"),h.textContent="on"}const c=document.getElementById("btn-theme-toggle"),d=document.getElementById("theme-lightmode"),f=document.getElementById("theme-darkmode"),g=document.querySelector("html"),h=document.getElementById("mode");c.addEventListener("click",c=>{c.preventDefault(),g.classList.toggle("light-theme");const e=g.classList.contains("light-theme");c.target.setAttribute("aria-pressed",e+""),e?a():b();const h=d.classList.contains("hide")?"hide":"",i=f.classList.contains("hide")?"hide":"";localStorage.setItem(THEME_STORAGE_KEY,JSON.stringify([e,h,i]))}),function(){const d=JSON.parse(localStorage.getItem(THEME_STORAGE_KEY))||[!1,"",""],e=d[0];e?(g.classList.add("light-theme"),a()):(g.classList.remove("light-theme"),b()),c.setAttribute("aria-pressed",e+"")}()}loadingAnimation();function loadingAnimation(){window.addEventListener("load",()=>{const a=document.getElementById("loader"),b=document.getElementById("page-loaded");a.classList.add("loader-hidden"),a.addEventListener("transitionend",()=>{a.remove(),b.textContent="Page has loaded.",b.setAttribute("aria-hidden","false")})})}currencySelector();function currencySelector(){function a(a){c.forEach(b=>{b.textContent="GBP"===a?`${d}`:"EUR"===a?`${e}`:"USD"===a?`${f}`:"AUD"===a?`${g}`:"JPY"===a?`${h}`:"CNY"===a?`${i}`:"INR"===a?`${j}`:`${d}`})}const b=document.getElementById("currency-select"),c=document.querySelectorAll("[data-selected-currency]"),d="\xA3",e="\u20AC",f="$",g="$",h="\xA5",i="\u5143",j="\u20A8",k=localStorage.getItem(CURRENCY_STORAGE_KEY)||"GBP";b.value=k,a(k),b.addEventListener("change",b=>{const c=b.target.value;a(c),localStorage.setItem(CURRENCY_STORAGE_KEY,c)})}const deleteAllBtn=document.querySelector("[data-delete-all-entries]");deleteAllBtn.setAttribute("disabled",""),deleteAllEntries();function deleteAllEntries(){deleteAllBtn.addEventListener("click",()=>{if(window.confirm("Do you really want to delete all entries?")){["COSTS_v2_LOCAL-entries","COSTS_v2_LOCAL-sort-buttons-enabled"].forEach(a=>{for(let b=0;b<localStorage.length;b++){const c=localStorage.key(b);c.startsWith(a)&&localStorage.removeItem(c)}}),window.location.reload()}})}function enableDeleteAllBtn(a){0<a.length&&deleteAllBtn.removeAttribute("disabled")}const expandTableBtn=document.querySelector("[data-expand-table]");expandTableBtn.setAttribute("disabled","");function enableExpandTableBtn(a){7<a.length&&expandTableBtn.removeAttribute("disabled")}costsCalculator();function costsCalculator(){function a(a){const b=q.content.cloneNode(!0),d=b.querySelector(".costs-row");d.dataset.entryId=a.id;const f=b.querySelector("[data-date]"),g=b.querySelector("[data-item-type]"),h=b.querySelector("[data-daily-cost]"),i=a.date.split("/"),j=new Date(`${i[1]}/${i[0]}/${i[2]}`);f.textContent=j.toLocaleDateString("en-GB"),h.textContent=a.poundsPlusPence.toFixed(2),g.textContent=a.item;const k=parseInt(m.rows.length+1);n.textContent=k,s.push(parseFloat(h.textContent));const l=s.reduce((a,b)=>a+b,0);o.textContent=l.toFixed(2);const r=parseFloat(o.textContent);p.textContent=(r/k).toFixed(2),e(),enableDeleteAllBtn(t),enableExpandTableBtn(t),c(),m.appendChild(b)}function b(){localStorage.setItem(COSTS_STORAGE_KEY,JSON.stringify(t))}function c(){const a=document.querySelector("[data-table-heading-daily-spend]");7<t.length&&a.classList.add("table-heading-shadow")}function d(){b(),m.innerHTML="",t.forEach(b=>a(b))}function e(){2<=t.length?(r.removeAttribute("disabled"),localStorage.setItem(SORT_DATE_BUTTONS_STORAGE_KEY,"true")):(r.setAttribute("disabled",""),localStorage.setItem(SORT_DATE_BUTTONS_STORAGE_KEY,"false"))}function f(a){const b=a.split("/"),c=b.reverse(),d=c.join("/");return new Date(d)}const g=document.getElementById("costs-form"),h=document.querySelector("[data-input-date]"),i=document.querySelector("[data-input-items]"),j=document.querySelector("[data-input-pounds]"),k=document.querySelector("[data-input-pence]"),l=document.querySelectorAll("[data-input-number]"),m=document.querySelector("[data-rows]"),n=document.querySelector("[data-total-days]"),o=document.querySelector("[data-total-costs]"),p=document.querySelector("[data-average-spend]"),q=document.getElementById("costs-template"),r=document.querySelector("[data-sort-button]");r.setAttribute("disabled",""),g.addEventListener("submit",c=>{c.preventDefault();const d=i.value,e=h.value,f=e.split("-"),g=f.reverse().join("/");if(""===j.value)return void alert(`Enter a number greater than or equal to zero`);if(""===k.value)return void alert("Enter a number between 0 and 99");const l=100*parseInt(j.value),m=parseInt(k.value),n={date:g,item:d,poundsPlusPence:(l+m)/100,id:new Date().valueOf().toString()};t.push(n),a(n),b(),h.value="",i.value="Shopping",j.value=0,k.value=0}),i.addEventListener("click",a=>{a.target.value=""}),l.forEach(a=>{a.addEventListener("click",a=>{a.target.value=""})});const s=[];let t=function(){const a=localStorage.getItem(COSTS_STORAGE_KEY),b=JSON.parse(a)||[];return 0<b.length&&b.sort((c,a)=>new Date(c.date)-new Date(a.date)),b}();t.forEach(b=>a(b)),globalEventListener("click","[data-button-delete]",a=>{const c=a.target.closest(".costs-row");c.remove();const d=c.dataset.entryId;t=t.filter(a=>a.id!==d),b(),window.location.reload()}),currencySelector(),globalEventListener("click","[data-button-type-edit]",a=>{a.target.textContent="Edit"===a.target.textContent?"Save edit":"Edit";const b=a.target.closest(".costs-row"),c=b.querySelector("[data-item-type]");c.toggleAttribute("contenteditable");const d=b.dataset.entryId,e=t.find(a=>a.id===d);e.edited=!c.hasAttribute("contenteditable"),e.edited&&(e.item=c.textContent),localStorage.setItem(COSTS_STORAGE_KEY,JSON.stringify(t))}),r.addEventListener("click",()=>{t.sort((c,a)=>f(c.date)-f(a.date)),s.length=0,d()}),expandTableBtn.addEventListener("click",a=>{const b=document.querySelector("[data-costs-table-container]"),c=document.querySelector("[data-costs-table-header]");a.target.textContent="Expand table"===a.target.textContent?"Contract table":"Expand table",b.classList.toggle("table-entries-max-height"),c.classList.toggle("sticky")})}function globalEventListener(a,b,c,d=!1){document.addEventListener(a,a=>{a.target.matches(b)&&c(a)},d)}